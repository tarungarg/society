<%= render partial: 'clubs/header/header'%>

<section class="content">

  <div class="box box-warning">
    <div class="box-header with-border">
      <div class="pull-right">
        <%= link_to 'Create Event', new_club_path, class: 'btn btn-primary' %>
      </div>
    </div>
    <div class="box-body">
      <table class="table table-striped">
        <tr>
          <th>Title</th>
          <th>From time</th>
          <th>To time</th>
          <th colspan="3"></th>
        </tr>
        <% @clubs.each do |club| %>
          <tr>
            <td><%= club.title %></td>
            <td><%= basic_date_only club.from_time %></td>
            <td><%= basic_date_only club.to_time %></td>
            <td><%= link_to 'Show', club %></td>
            <td><%= link_to 'Edit', edit_club_path(club) %></td>
            <td><%= link_to 'Destroy', club, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
        <% end %>
      </table>
    </div>
  </div>
  <div>
      <div class="calendar"></div>
  </div>
</section>

<script type="text/javascript">
  $(document).ready(function(){
      $('.calendar').fullCalendar({
        theme: true,
        eventOverlap: false,
        header: {
          left: 'prev,next today',
          center: 'title',
          right: 'month,agendaWeek,agendaDay'
        },
        events: "/clubs",
        displayEventEnd: true,
        buttonText: {
          today: 'today',
          month: 'month',
          week: 'week',
          day: 'day'
        },
        eventAfterRender: function (event, element, view) {
        var dataHoje = new Date();
        if (event.start < dataHoje && event.end > dataHoje) {
            //event.color = "#FFB347"; //Em andamento
            element.css('background-color', '#f39c12');
        } else if (event.start < dataHoje && event.end < dataHoje) {
            //event.color = "#77DD77"; //Concluído OK
            element.css('background-color', '#3c8dbc');
        } else if (event.start > dataHoje && event.end > dataHoje) {
            //event.color = "#AEC6CF"; //Não iniciado
            element.css('background-color', '#00a65a');
        }
      },
    });
  })
</script>